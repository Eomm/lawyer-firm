---
// Get the base URL for proper redirects
const baseUrl = import.meta.env.BASE_URL || '/';
---

<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Studio Legale Ferrini</title>
    <script is:inline define:vars={{ baseUrl }}>
      // Immediate redirect - no function wrapper needed
      (function () {
        // Check if user has a language preference stored
        const stored = localStorage.getItem('preferredLanguage');
        if (stored && (stored === 'en' || stored === 'it')) {
          window.location.replace(`${baseUrl}${stored}/`);
          return;
        }

        // Check browser language
        const browserLang = navigator.language || navigator.languages[0];
        let lang = 'it'; // default

        if (browserLang.startsWith('en')) {
          lang = 'en';
        }

        // Store preference and redirect
        localStorage.setItem('preferredLanguage', lang);
        window.location.replace(`${baseUrl}${lang}/`);
      })();
    </script>
    <noscript>
      <meta http-equiv="refresh" content={`0; url=${baseUrl}it/`} />
    </noscript>
    <style>
      /* Hide body content until redirect */
      body {
        visibility: hidden;
      }
      .no-js {
        visibility: visible !important;
      }
    </style>
  </head>

  <body>
    <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif">
      <h1>Redirecting...</h1>
      <p>If you are not redirected automatically, <a href={`${baseUrl}it/`}>click here</a>.</p>
    </div>
  </body>
</html>
